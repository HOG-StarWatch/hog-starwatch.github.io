<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图种生成工具</title>
</head>
<body>
    <h1>图种生成工具</h1>
    <p>选择一张图片和一个文件，生成图种（文件隐藏在图片中）</p>
    
    <h2>第一步：选择图片</h2>
    <input type="file" id="imageFile" accept="image/*">
    
    <h2>第二步：选择要隐藏的文件</h2>
    <input type="file" id="dataFile">
    
    <h2>第三步：生成图种</h2>
    <button id="generateBtn">生成图种</button>
    
    <h2>第四步：下载结果</h2>
    <a id="downloadLink" style="display:none;">下载图种</a>
    
    <script>
        document.getElementById('generateBtn').addEventListener('click', function() {
            const imageFile = document.getElementById('imageFile').files[0];
            const dataFile = document.getElementById('dataFile').files[0];
            
            if (!imageFile || !dataFile) {
                alert('请先选择图片和要隐藏的文件！');
                return;
            }
            
            const reader1 = new FileReader();
            const reader2 = new FileReader();
            
            reader1.onload = function(e1) {
                reader2.onload = function(e2) {
                    // 将图片和数据合并
                    const combinedData = new Blob(
                        [e1.target.result, e2.target.result], 
                        {type: 'image/jpeg'}
                    );
                    
                    // 创建下载链接
                    const downloadLink = document.getElementById('downloadLink');
                    downloadLink.href = URL.createObjectURL(combinedData);
                    downloadLink.download = 'steganography.jpg';
                    downloadLink.style.display = 'block';
                };
                reader2.readAsArrayBuffer(dataFile);
            };
            reader1.readAsArrayBuffer(imageFile);
        });
    </script>
    
    <hr>
    <h3>使用说明：</h3>
    <ol>
        <li>选择一张图片作为载体</li>
        <li>选择要隐藏的文件</li>
        <li>点击"生成图种"按钮</li>
        <li>下载生成的图片</li>
        <li>要提取隐藏文件，将图片后缀改为.zip或其他对应格式</li>
    </ol>
    
    <h3>注意事项：</h3>
    <ul>
        <li>隐藏的文件大小不应超过图片大小的50%</li>
        <li>某些平台可能会重新压缩图片，导致隐藏文件损坏</li>
        <li>提取文件时可能需要使用解压软件</li>
    </ul>
</body>
</html>