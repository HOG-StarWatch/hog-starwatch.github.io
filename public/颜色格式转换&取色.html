<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>取色器</title>
    <style>
        /* 设置页面的基本样式 */
        body {
            font-family: Arial, sans-serif; /* 使用无衬线字体 */
            margin: 2em; /* 页面外边距 */
            display: flex; /* 使用flexbox布局 */
            flex-direction: column; /* 纵向排列子元素 */
            align-items: center; /* 居中对齐 */
            background-color: #f9f9f9; /* 背景颜色 */
            transition: background-color 0.3s; /* 背景颜色过渡效果 */
        }
        .container {
            display: flex; /* 使用flexbox布局 */
            justify-content: space-around; /* 子元素之间的间距 */
            width: 100%; /* 容器宽度 */
            max-width: 1200px; /* 容器最大宽度 */
            margin-bottom: 2em; /* 下边距 */
            background-color: #fff; /* 容器背景颜色 */
            border-radius: 8px; /* 圆角边框 */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* 阴影效果 */
            padding: 1em; /* 内边距 */
            transition: background-color 0.3s, color 0.3s; /* 背景颜色和文本颜色过渡效果 */
        }
        .color-section {
            margin: 1em; /* 每个颜色部分的外边距 */
            text-align: center; /* 文本居中 */
        }
        input {
            margin: 0.5em 0; /* 上下外边距 */
            padding: 0.5em; /* 内边距 */
            width: 200px; /* 输入框宽度 */
            border: 1px solid #ccc; /* 边框颜色 */
            border-radius: 4px; /* 圆角边框 */
            font-size: 16px; /* 字体大小 */
            transition: border-color 0.3s; /* 边框颜色过渡效果 */
        }
        .color-display {
            width: 200px; /* 颜色显示区域宽度 */
            height: 50px; /* 颜色显示区域高度 */
            margin: 1em 0; /* 上下外边距 */
            border: 1px solid #ccc; /* 边框颜色 */
            border-radius: 4px; /* 圆角边框 */
        }
        #imagePreview {
            margin-top: 1em; /* 上边距 */
            max-width: 960px; /* 最大宽度 */
            max-height: 540px; /* 最大高度 */
            border: 1px solid #ccc; /* 边框颜色 */
            display: none; /* 初始隐藏 */
        }
        hr {
            width: 100%; /* 水平线宽度 */
            border: 1px solid #eee; /* 水平线颜色 */
        }
        /* 夜间模式样式 */
        body.night-mode {
            background-color: #181818; /* 夜间模式背景颜色 */
            color: #f9f9f9; /* 夜间模式文本颜色 */
        }
        .container.night-mode {
            background-color: #282828; /* 夜间模式容器背景颜色 */
            box-shadow: 0 4px 8px rgba(255, 255, 255, 0.2); /* 调整阴影效果 */
        }
        input.night-mode {
            border-color: #444; /* 夜间模式输入框边框颜色 */
        }
    </style>
</head>
<body>
    <button onclick="goHome()">返回主页</button>
    <button id="toggleButton" onclick="toggleNightMode()">切换夜间模式</button> <!-- 切换按钮 -->
    <h1>取色器</h1> <!-- 主标题 -->
    <div class="container"> <!-- 容器 -->
        <div class="color-section"> <!-- HEX转RGB部分 -->
            <h2>HEX 转 RGB</h2> <!-- 子标题 -->
            <input type="text" id="hexInput" placeholder="输入 HEX 颜色" onfocus="addHash(this)" /> <!-- 输入框 -->
            <button onclick="convertHexToRgb()">转换</button> <!-- 转换按钮 -->
            <div class="color-display" id="colorDisplayHex"></div> <!-- 颜色显示区域 -->
            <p id="resultHex"></p> <!-- 结果文本 -->
        </div>
        <div class="color-section"> <!-- RGB转HEX部分 -->
            <h2>RGB 转 HEX</h2> <!-- 子标题 -->
            输入 RGB 值 (例如，255, 0, 0): <br> <!-- 说明文本 -->
            <input type="text" id="rgbInput" placeholder="输入 RGB 颜色" onfocus="addComma(this)" /> <!-- 输入框 -->
            <button onclick="convertRgbToHex()">转换</button> <!-- 转换按钮 -->
            <div class="color-display" id="colorDisplayRgb"></div> <!-- 颜色显示区域 -->
            <p id="resultRgb"></p> <!-- 结果文本 -->
        </div>
        <div class="color-section"> <!-- 动态取色器部分 -->
            <h2>动态取色器</h2> <!-- 子标题 -->
            <input type="color" id="colorPicker" onchange="updateColor(this.value)" /> <!-- 颜色选择器 -->
            <div class="color-display" id="colorDisplayPicker"></div> <!-- 颜色显示区域 -->
            <p id="resultPicker"></p> <!-- 结果文本 -->
        </div>
    </div>
    <hr> <!-- 水平线 -->
    <h2>图片预览</h2> <!-- 子标题 -->
    <input type="file" id="fileInput" accept="image/*" onchange="previewImage()" /> <!-- 文件输入框 -->
    <div style="text-align: center;"> <!-- 图片预览区域 -->
        <img id="imagePreview" alt="图片预览" /> <!-- 图片元素 -->
    </div>
    <script>
        // 在输入框获得焦点时添加 #
        function addHash(input) {
            if (input.value.length === 0) {
                input.value = '#'; // 如果输入为空，则添加#
            }
        }

        // 在RGB输入框获得焦点时添加初始值
        function addComma(input) {
            if (input.value.length === 0) {
                input.value = '0, 0, 0'; // 默认值
            }
        }

        // 将HEX颜色转换为RGB颜色
        function convertHexToRgb() {
            let hex = document.getElementById('hexInput').value;
            if (!hex.startsWith('#')) { // 如果没有#
                hex = '#' + hex; // 添加#
            }
            const hexValue = hex.slice(1); // 去掉#
            if (hexValue.length !== 6) { // 检查格式
                alert("无效的 HEX 颜色格式");
                return; // 返回
            }
            // 解析RGB值
            const r = parseInt(hexValue.slice(0, 2), 16);
            const g = parseInt(hexValue.slice(2, 4), 16);
            const b = parseInt(hexValue.slice(4, 6), 16);
            // 显示结果
            document.getElementById('resultHex').innerText = `RGB: (${r}, ${g}, ${b})`;
            document.getElementById('colorDisplayHex').style.backgroundColor = hex; // 更新颜色显示区域
        }

        // 将RGB颜色转换为HEX颜色
        function convertRgbToHex() {
            const rgbInput = document.getElementById('rgbInput').value;
            const rgbValues = rgbInput.split(',').map(Number); // 分割并转换为数字
            // 检查RGB值是否有效
            if (rgbValues.length !== 3 || rgbValues.some(value => isNaN(value) || value < 0 || value > 255)) {
                alert("无效的 RGB 颜色值");
                return; // 返回
            }
            const r = rgbValues[0];
            const g = rgbValues[1];
            const b = rgbValues[2];
            const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)}`; // 转换为HEX
            // 显示结果
            document.getElementById('resultRgb').innerText = `HEX: ${hex}`;
            document.getElementById('colorDisplayRgb').style.backgroundColor = hex; // 更新颜色显示区域
        }

        // 更新动态取色器的显示颜色
        function updateColor(color) {
            document.getElementById('colorDisplayPicker').style.backgroundColor = color; // 更新显示区域
            const hex = color.toUpperCase(); // 转为大写
            // 解析RGB值
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            // 显示RGB结果
            document.getElementById('resultPicker').innerText = `RGB: (${r}, ${g}, ${b})`;
        }

        // 预览选择的图片
        function previewImage() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            const imagePreview = document.getElementById('imagePreview');
            if (file) {
                const reader = new FileReader(); // 创建文件读取器
                reader.onload = function(e) {
                    imagePreview.src = e.target.result; // 设置图片源
                    imagePreview.style.display = 'block'; // 显示图片
                }
                reader.readAsDataURL(file); // 读取文件为Data URL
            }
        }

        // 切换夜间模式
        function toggleNightMode() {
            const body = document.body;
            const container = document.querySelector('.container');
            const inputs = document.querySelectorAll('input');

            // 切换类名
            body.classList.toggle('night-mode');
            container.classList.toggle('night-mode');

            inputs.forEach(input => {
                input.classList.toggle('night-mode'); // 切换输入框的夜间模式样式
            });
        }

        // 定义返回主页函数
        function goHome() {
            window.location.href = "/";
        }
    </script>
</body>
</html>
