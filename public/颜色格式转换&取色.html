<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¨ ç»¼åˆå–è‰²å™¨</title>
    <style>
        /* åŸºç¡€æ ·å¼è®¾ç½® */
        body {
            font-family: Arial, sans-serif; /* ä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ä½“ */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #121212; /* é»˜è®¤å¤œé—´æ¨¡å¼èƒŒæ™¯è‰² */
            color: #e0e0e0; /* é»˜è®¤å¤œé—´æ¨¡å¼å­—ä½“é¢œè‰² */
            transition: background-color 0.3s, color 0.3s; /* èƒŒæ™¯å’Œå­—ä½“é¢œè‰²è¿‡æ¸¡æ•ˆæœ */
            min-height: 100vh;
        }

        /* ä¸»æ ‡é¢˜æ ·å¼ */
        h1, h2 {
            color: inherit; /* ç»§æ‰¿bodyçš„å­—ä½“é¢œè‰² */
            text-align: center;
        }

        /* æ¨¡å¼åˆ‡æ¢æŒ‰é’®æ ·å¼ */
        #toggleButton {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #bb86fc; /* å¤œé—´æ¨¡å¼æŒ‰é’®é¢œè‰² */
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            z-index: 1000;
        }

        /* æŒ‰é’®æ‚¬åœæ•ˆæœ */
        #toggleButton:hover {
            background-color: #9b59b6; /* å¤œé—´æ¨¡å¼æŒ‰é’®æ‚¬åœé¢œè‰² */
        }

        /* ä¸»åŠŸèƒ½å®¹å™¨æ ·å¼ */
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            width: 90%;
            max-width: 1200px;
            margin: 80px 0 30px 0; /* é¡¶éƒ¨ç•™å‡ºç©ºé—´ç»™åˆ‡æ¢æŒ‰é’® */
            background-color: #1e1e1e; /* å¤œé—´æ¨¡å¼å®¹å™¨èƒŒæ™¯è‰² */
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.05); /* å¤œé—´æ¨¡å¼é˜´å½± */
            padding: 30px;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        /* è‰²å¡ç”Ÿæˆä¸å±•ç¤ºå®¹å™¨æ ·å¼ */
        .palette-container {
            display: flex;
            flex-direction: column; /* å‚ç›´æ’åˆ—å­å…ƒç´  */
            align-items: center;
            width: 100%;
            max-width: 1200px;
            margin: 30px 0;
            background-color: #1e1e1e; /* å¤œé—´æ¨¡å¼å®¹å™¨èƒŒæ™¯è‰² */
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.05); /* å¤œé—´æ¨¡å¼é˜´å½± */
            padding: 30px;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        /* è‰²å¡ç”Ÿæˆé¡¶éƒ¨åŒºåŸŸï¼ŒåŒ…å«å›¾ç‰‡ç”Ÿæˆå’Œéšæœºç”Ÿæˆä¸¤ä¸ªéƒ¨åˆ† */
        .palette-top {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            width: 100%;
        }

        /* åŠŸèƒ½æ¿å—çš„æ ·å¼ */
        .color-section {
                flex: 1 1 280px;
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
        }

        .color-section h2 {
            margin-bottom: 20px;
            color: inherit; /* ç»§æ‰¿bodyçš„å­—ä½“é¢œè‰² */
        }

        /* è¾“å…¥æ¡†æ ·å¼ */
        input[type="text"], input[type="color"], input[type="file"] {
            margin: 10px 0;
            padding: 10px 15px;
            width: 100%;
            max-width: 250px;
            border: 2px solid #555; /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†è¾¹æ¡†è‰² */
            border-radius: 8px;
            font-size: 16px;
            background-color: #2c2c2c; /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†èƒŒæ™¯è‰² */
            color: #e0e0e0; /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†å­—ä½“è‰² */
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s, color 0.3s;
        }

        /* è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶çš„æ ·å¼ */
        input[type="text"]:focus, input[type="color"]:focus {
            border-color: #bb86fc; /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†èšç„¦è¾¹æ¡†è‰² */
            box-shadow: 0 0 5px rgba(187, 134, 252, 0.5); /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†èšç„¦é˜´å½± */
            outline: none;
        }

        /* æŒ‰é’®æ ·å¼ */
        button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #bb86fc; /* å¤œé—´æ¨¡å¼æŒ‰é’®é¢œè‰² */
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.2s;
        }

        /* æŒ‰é’®æ‚¬åœæ•ˆæœ */
        button:hover {
            background-color: #9b59b6; /* å¤œé—´æ¨¡å¼æŒ‰é’®æ‚¬åœé¢œè‰² */
            transform: translateY(-2px);
        }

        /* é¢œè‰²æ˜¾ç¤ºåŒºåŸŸæ ·å¼ */
        .color-display {
            width: 100%;
            max-width: 250px;
            height: 60px;
            margin: 15px 0;
            border: 2px solid #555; /* å¤œé—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºè¾¹æ¡†è‰² */
            border-radius: 8px;
            box-shadow: inset 0 0 5px rgba(255,255,255,0.1); /* å¤œé—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºé˜´å½± */
            background-color: #2c2c2c; /* é»˜è®¤é¢œè‰²æ˜¾ç¤ºèƒŒæ™¯è‰² */
            transition: background-color 0.3s, box-shadow 0.3s, border-color 0.3s;
        }

        /* ç»“æœæ–‡æœ¬æ ·å¼ */
        p {
            font-size: 18px;
            color: inherit; /* ç»§æ‰¿bodyçš„å­—ä½“é¢œè‰² */
        }

        /* åˆ†å‰²çº¿æ ·å¼ */
        hr {
            width: 90%;
            max-width: 1200px;
            border: none;
            border-top: 2px solid #444; /* å¤œé—´æ¨¡å¼åˆ†å‰²çº¿é¢œè‰² */
            margin: 30px 0;
        }

        /* è‰²å¡å±•ç¤ºåŒºåŸŸæ ·å¼ */
        #color-palette {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        /* è‰²å¡å—æ ·å¼ */
        .color-swatch {
            width: 150px;
            height: 150px;
            margin: 10px;
            border-radius: 8px;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            background-color: #2c2c2c; /* é»˜è®¤è‰²å—èƒŒæ™¯è‰² */
        }

        /* è‰²å¡å—æ‚¬åœæ•ˆæœ */
        .color-swatch:hover {
            transform: scale(1.05);
        }

        /* è‰²å¡ä»£ç æ˜¾ç¤ºæ ·å¼ */
        .color-code {
            width: 100%;
            text-align: center;
            color: #fff;
            font-weight: bold;
            text-shadow: 1px 1px 2px #000;
            font-size: 16px;
            padding-bottom: 10px;
        }

        /* å¤œé—´æ¨¡å¼æ ·å¼ */
        .night-mode {
            background-color: #121212; /* å¤œé—´æ¨¡å¼èƒŒæ™¯è‰² */
            color: #e0e0e0; /* å¤œé—´æ¨¡å¼å­—ä½“é¢œè‰² */
        }

        .night-mode .container, 
        .night-mode .palette-container {
            background-color: #1e1e1e; /* å¤œé—´æ¨¡å¼å®¹å™¨èƒŒæ™¯è‰² */
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.05); /* å¤œé—´æ¨¡å¼é˜´å½± */
        }

        .night-mode input[type="text"],
        .night-mode input[type="color"],
        .night-mode input[type="file"] {
            border-color: #555; /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†è¾¹æ¡†è‰² */
            background-color: #2c2c2c; /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†èƒŒæ™¯è‰² */
            color: #e0e0e0; /* å¤œé—´æ¨¡å¼è¾“å…¥æ¡†å­—ä½“è‰² */
        }

        .night-mode .color-display {
            border-color: #555; /* å¤œé—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºè¾¹æ¡†è‰² */
            box-shadow: inset 0 0 5px rgba(255,255,255,0.1); /* å¤œé—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºé˜´å½± */
            background-color: #2c2c2c; /* å¤œé—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºèƒŒæ™¯è‰² */
        }

        .night-mode button {
            background-color: #bb86fc; /* å¤œé—´æ¨¡å¼æŒ‰é’®é¢œè‰² */
        }

        .night-mode button:hover {
            background-color: #9b59b6; /* å¤œé—´æ¨¡å¼æŒ‰é’®æ‚¬åœé¢œè‰² */
        }

        /* æ—¥é—´æ¨¡å¼æ ·å¼ */
        .day-mode {
            background-color: #f0f4f8; /* æ—¥é—´æ¨¡å¼èƒŒæ™¯è‰² */
            color: #333; /* æ—¥é—´æ¨¡å¼å­—ä½“é¢œè‰² */
        }

        .day-mode .container, 
        .day-mode .palette-container {
            background-color: #ffffff; /* æ—¥é—´æ¨¡å¼å®¹å™¨èƒŒæ™¯è‰² */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1); /* æ—¥é—´æ¨¡å¼é˜´å½± */
        }

        .day-mode input[type="text"],
        .day-mode input[type="color"],
        .day-mode input[type="file"] {
            border-color: #ccc; /* æ—¥é—´æ¨¡å¼è¾“å…¥æ¡†è¾¹æ¡†è‰² */
            background-color: #ffffff; /* æ—¥é—´æ¨¡å¼è¾“å…¥æ¡†èƒŒæ™¯è‰² */
            color: #333; /* æ—¥é—´æ¨¡å¼è¾“å…¥æ¡†å­—ä½“è‰² */
        }

        .day-mode .color-display {
            border-color: #ccc; /* æ—¥é—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºè¾¹æ¡†è‰² */
            box-shadow: inset 0 0 5px rgba(0,0,0,0.1); /* æ—¥é—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºé˜´å½± */
            background-color: #ffffff; /* æ—¥é—´æ¨¡å¼é¢œè‰²æ˜¾ç¤ºèƒŒæ™¯è‰² */
        }

        .day-mode button {
            background-color: #4B0082; /* æ—¥é—´æ¨¡å¼æŒ‰é’®é¢œè‰² */
        }

        .day-mode button:hover {
            background-color: #320255; /* æ—¥é—´æ¨¡å¼æŒ‰é’®æ‚¬åœé¢œè‰² */
        }

        /* å›¾ç‰‡é¢„è§ˆæ ·å¼ */
        #imagePreview {
            margin-top: 20px;
            max-width: 100%;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: none;
            transition: transform 0.3s;
        }

        /* å›¾ç‰‡é¢„è§ˆæ‚¬åœæ•ˆæœ */
        #imagePreview:hover {
            transform: scale(1.02);
        }

        /* è‰²å¡ç”ŸæˆæŒ‰é’®æ ·å¼ */
        #generate-btn, #random-generate-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #bb86fc; /* å¤œé—´æ¨¡å¼æŒ‰é’®é¢œè‰² */
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        /* è‰²å¡ç”ŸæˆæŒ‰é’®æ‚¬åœæ•ˆæœ */
        #generate-btn:hover, #random-generate-btn:hover {
            background-color: #9b59b6; /* å¤œé—´æ¨¡å¼æŒ‰é’®æ‚¬åœé¢œè‰² */
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container, .palette-container {
                flex-direction: column;
                align-items: center;
            }

            .color-section {
                width: 100%;
                max-width: 400px;
            }

            #toggleButton {
                position: static;
                margin-bottom: 20px;
            }

            .palette-top {
                flex-direction: column; /* å°å±å¹•ä¸‹å‚ç›´æ’åˆ— */
            }

            .palette-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body class="night-mode"> <!-- é»˜è®¤å¯ç”¨å¤œé—´æ¨¡å¼ -->

    <!-- å¤œé—´æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
    <button id="toggleButton" onclick="toggleNightMode()">â˜€ï¸ åˆ‡æ¢æ—¥é—´æ¨¡å¼</button>
    
    <!-- ä¸»æ ‡é¢˜ -->
    <h1>ğŸ¨ ç»¼åˆå–è‰²å™¨</h1>
    
    <!-- ä¸»åŠŸèƒ½å®¹å™¨ -->
    <div class="container">
        <!-- HEXè½¬RGBéƒ¨åˆ† -->
        <div class="color-section">
            <h2>ğŸ”„ HEX è½¬ RGB</h2>
            <p>è¾“å…¥ HEX å€¼ (ä¾‹å¦‚ï¼Œ#FF00FF):</p>
            <input type="text" id="hexInput" placeholder="è¾“å…¥ HEX å€¼" onfocus="addHash(this)" />
            <button onclick="convertHexToRgb()">è½¬æ¢</button>
            <div class="color-display" id="colorDisplayHex"></div>
            <p id="resultHex">RGB: -</p>
        </div>
        
        <!-- RGBè½¬HEXéƒ¨åˆ† -->
        <div class="color-section">
            <h2>ğŸ”„ RGB è½¬ HEX</h2>
            <p>è¾“å…¥ RGB å€¼ (ä¾‹å¦‚ï¼Œ255, 0, 255):</p>
            <input type="text" id="rgbInput" placeholder="è¾“å…¥ RGB å€¼ !!æ³¨æ„è¯·è¾“å…¥è‹±æ–‡é€—å·" onfocus="addComma(this)" />
            <button onclick="convertRgbToHex()">è½¬æ¢</button>
            <div class="color-display" id="colorDisplayRgb"></div>
            <p id="resultRgb">HEX: -</p>
        </div>
        
        <!-- åŠ¨æ€å–è‰²å™¨éƒ¨åˆ† -->
        <div class="color-section">
            <h2>ğŸ¨ åŠ¨æ€å–è‰²å™¨</h2>
            <input type="color" id="colorPicker" onchange="updateColor(this.value)" />
            <div class="color-display" id="colorDisplayPicker"></div>
            <p id="resultPicker">RGB: -</p>
        </div>
    </div>
    
    <!-- æ–°å¢çš„è‰²å¡ç”Ÿæˆä¸å±•ç¤ºå®¹å™¨ -->
    <div class="palette-container">
        <!-- è‰²å¡ç”Ÿæˆé¡¶éƒ¨åŒºåŸŸï¼ŒåŒ…å«åŸºäºå›¾ç‰‡çš„ç”Ÿæˆå’Œéšæœºç”Ÿæˆ -->
        <div class="palette-top">
            <!-- åŸºäºå›¾ç‰‡çš„è‰²å¡ç”Ÿæˆéƒ¨åˆ† -->
            <div class="color-section">
                <h2>ğŸ–¼ï¸ åŸºäºå›¾ç‰‡çš„è‰²å¡ç”Ÿæˆ</h2>
                <input type="file" id="fileInput" accept="image/*" onchange="previewImage()" />
                <img id="imagePreview" alt="å›¾ç‰‡é¢„è§ˆ" />
                <button id="generate-btn">ç”Ÿæˆè‰²å¡</button>
            </div>
    
            <!-- éšæœºç”Ÿæˆè‰²å¡æŒ‰é’® -->
            <div class="color-section">
                <h2>ğŸ² éšæœºç”Ÿæˆè‰²å¡</h2>
                <button id="random-generate-btn" onclick="generateRandomColorPalette()">éšæœºç”Ÿæˆè‰²å¡</button>
            </div>
        </div>

        <!-- è‰²å¡å±•ç¤ºåŒºåŸŸï¼Œç½®äºé¡¶éƒ¨åŒºåŸŸä¸‹æ–¹ -->
        <div class="color-section" style="width: 100%;">
            <h2>ğŸ¨ è‰²å¡å±•ç¤º</h2>
            <div id="color-palette"></div>
        </div>
    </div>
    
    <hr>
    
    <!-- å¼•å…¥ Color Thief åº“ï¼Œé€šè¿‡ CDN -->
    <script src="color-thief.umd.js"></script>
    
    <script>
        /* 
            åœ¨è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶æ·»åŠ  # å·
            å¦‚æœè¾“å…¥æ¡†ä¸ºç©ºï¼Œè‡ªåŠ¨æ·»åŠ  # å·
        */
        function addHash(input) {
            if (input.value.length === 0) {
                input.value = '#'; // å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œåˆ™æ·»åŠ  #
            }
        }

        /* 
            åœ¨RGBè¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶æ·»åŠ é»˜è®¤å€¼
            å¦‚æœè¾“å…¥æ¡†ä¸ºç©ºï¼Œè‡ªåŠ¨å¡«å…… '255, 0, 255'
        */
        function addComma(input) {
            if (input.value.trim() === '') {
                input.value = '255, 0, 255'; // é»˜è®¤å€¼
            }
        }

        /* 
            å°† HEX é¢œè‰²è½¬æ¢ä¸º RGB é¢œè‰²
            è·å–è¾“å…¥çš„ HEX å€¼ï¼Œè½¬æ¢ä¸º RGBï¼Œå¹¶æ˜¾ç¤ºç»“æœ
        */
        function convertHexToRgb() {
            let hex = document.getElementById('hexInput').value.trim();
            if (!hex.startsWith('#')) { // å¦‚æœæ²¡æœ‰ # å·ï¼Œåˆ™æ·»åŠ 
                hex = '#' + hex;
            }
            const hexValue = hex.slice(1); // å»æ‰ #
            // æ£€æŸ¥ HEX æ ¼å¼æ˜¯å¦æ­£ç¡®
            if (hexValue.length !== 6 || !/^([0-9A-Fa-f]{6})$/.test(hexValue)) {
                alert("æ— æ•ˆçš„ HEX é¢œè‰²æ ¼å¼");
                return;
            }
            // è§£æ RGB å€¼
            const r = parseInt(hexValue.slice(0, 2), 16);
            const g = parseInt(hexValue.slice(2, 4), 16);
            const b = parseInt(hexValue.slice(4, 6), 16);
            // æ˜¾ç¤ºç»“æœ
            document.getElementById('resultHex').innerText = `RGB: (${r},${g}, ${b})`;
            document.getElementById('colorDisplayHex').style.backgroundColor = hex; // æ›´æ–°é¢œè‰²æ˜¾ç¤ºåŒºåŸŸ
            // æ ¹æ®å½“å‰ä¸»é¢˜è°ƒæ•´æ ·å¼
            toggleNightModeIfNeeded('colorDisplayHex', hex);
        }

        /* 
            å°† RGB é¢œè‰²è½¬æ¢ä¸º HEX é¢œè‰²
            è·å–è¾“å…¥çš„ RGB å€¼ï¼Œè½¬æ¢ä¸º HEXï¼Œå¹¶æ˜¾ç¤ºç»“æœ
        */
        function convertRgbToHex() {
            const rgbInput = document.getElementById('rgbInput').value.trim();
            const rgbValues = rgbInput.split(',').map(item => parseInt(item.trim())); // åˆ†å‰²å¹¶è½¬æ¢ä¸ºæ•°å­—
            // æ£€æŸ¥ RGB å€¼æ˜¯å¦æœ‰æ•ˆ
            if (rgbValues.length !== 3 || rgbValues.some(value => isNaN(value) || value < 0 || value > 255)) {
                alert("æ— æ•ˆçš„ RGB é¢œè‰²å€¼");
                return;
            }
            const [r, g, b] = rgbValues;
            const hex = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1).toUpperCase()}`; // è½¬æ¢ä¸º HEX
            // æ˜¾ç¤ºç»“æœ
            document.getElementById('resultRgb').innerText = `HEX: ${hex}`;
            document.getElementById('colorDisplayRgb').style.backgroundColor = hex; // æ›´æ–°é¢œè‰²æ˜¾ç¤ºåŒºåŸŸ
            // æ ¹æ®å½“å‰ä¸»é¢˜è°ƒæ•´æ ·å¼
            toggleNightModeIfNeeded('colorDisplayRgb', hex);
        }

        /* 
            æ›´æ–°åŠ¨æ€å–è‰²å™¨çš„æ˜¾ç¤ºé¢œè‰²
            ç›‘å¬é¢œè‰²é€‰æ‹©å™¨çš„å˜åŒ–ï¼Œæ˜¾ç¤ºé€‰æ‹©çš„é¢œè‰²åŠå…¶ RGB å€¼
        */
        function updateColor(color) {
            const hex = color.toUpperCase();
            document.getElementById('colorDisplayPicker').style.backgroundColor = hex; // æ›´æ–°æ˜¾ç¤ºåŒºåŸŸ
            // è§£æ RGB å€¼
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            // æ˜¾ç¤º RGB ç»“æœ
            document.getElementById('resultPicker').innerText = `RGB: (${r},${g}, ${b})`;
            // æ ¹æ®å½“å‰ä¸»é¢˜è°ƒæ•´æ ·å¼
            toggleNightModeIfNeeded('colorDisplayPicker', hex);
        }

        /* 
            é¢„è§ˆé€‰æ‹©çš„å›¾ç‰‡
            ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡åï¼Œæ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
        */
        function previewImage() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            const imagePreview = document.getElementById('imagePreview');
            if (file) {
                const reader = new FileReader(); // åˆ›å»ºæ–‡ä»¶è¯»å–å™¨
                reader.onload = function(e) {
                    imagePreview.src = e.target.result; // è®¾ç½®å›¾ç‰‡æº
                    imagePreview.style.display = 'block'; // æ˜¾ç¤ºå›¾ç‰‡
                }
                reader.readAsDataURL(file); // è¯»å–æ–‡ä»¶ä¸º Data URL
            }
        }

        /* 
            åˆ‡æ¢å¤œé—´æ¨¡å¼å’Œæ—¥é—´æ¨¡å¼
            åˆ‡æ¢bodyçš„classï¼Œæ”¹å˜ä¸»é¢˜é¢œè‰²ï¼Œå¹¶æ›´æ–°æŒ‰é’®æ–‡æœ¬
        */
        function toggleNightMode() {
            const body = document.body;
            const toggleBtn = document.getElementById('toggleButton');

            if (body.classList.contains('night-mode')) {
                body.classList.remove('night-mode');
                body.classList.add('day-mode');
                toggleBtn.innerText = 'ğŸŒ™ åˆ‡æ¢å¤œé—´æ¨¡å¼';
            } else {
                body.classList.remove('day-mode');
                body.classList.add('night-mode');
                toggleBtn.innerText = 'â˜€ï¸ åˆ‡æ¢æ—¥é—´æ¨¡å¼';
            }
        }

        /* 
            æ ¹æ®å½“å‰ä¸»é¢˜è°ƒæ•´é¢œè‰²æ˜¾ç¤ºåŒºåŸŸçš„æ ·å¼
            ç¡®ä¿é¢œè‰²æ˜¾ç¤ºåŒºåŸŸçš„è¾¹æ¡†é¢œè‰²ä¸å½“å‰ä¸»é¢˜åŒ¹é…
        */
        function toggleNightModeIfNeeded(elementId, color) {
            const body = document.body;
            const element = document.getElementById(elementId);
            if (body.classList.contains('night-mode')) {
                // å¤œé—´æ¨¡å¼ä¸‹ä½¿ç”¨é»˜è®¤æ ·å¼
                element.style.borderColor = '#555';
            } else {
                // æ—¥é—´æ¨¡å¼ä¸‹ä½¿ç”¨é»˜è®¤æ ·å¼
                element.style.borderColor = '#ccc';
            }
        }

        // åˆå§‹åŒ– Color Thief å®ä¾‹ï¼Œç”¨äºä»å›¾ç‰‡ä¸­æå–é¢œè‰²
        const colorThief = new ColorThief();

        /* 
            å°† RGB è½¬ä¸º HEX
            è¾…åŠ©å‡½æ•°ï¼Œå°†RGBå€¼è½¬æ¢ä¸ºHEXå­—ç¬¦ä¸²
        */
        function rgbToHex(r, g, b) {
            return "#" + [r, g, b].map(x => {
                const hex = x.toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            }).join('');
        }

        /* 
            å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿
            ä½¿ç”¨Clipboard APIå°†æ–‡æœ¬å¤åˆ¶åˆ°ç”¨æˆ·å‰ªè´´æ¿
        */
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert(`å·²å¤åˆ¶é¢œè‰²ä»£ç : ${text}`);
            }, () => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶é¢œè‰²ä»£ç ã€‚');
            });
        }

        /* 
            ç”Ÿæˆéšæœº HEX é¢œè‰²
            è¿”å›ä¸€ä¸ªéšæœºç”Ÿæˆçš„HEXé¢œè‰²ä»£ç 
        */
        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        /* 
            æ˜¾ç¤ºè‰²å¡
            å°†ç»™å®šçš„é¢œè‰²æ•°ç»„æ˜¾ç¤ºåœ¨è‰²å¡å±•ç¤ºåŒºåŸŸï¼Œæ¯ä¸ªè‰²å¡å¯ç‚¹å‡»å¤åˆ¶é¢œè‰²ä»£ç 
        */
        function displayColorPalette(palette) {
            const colorPalette = document.getElementById('color-palette');
            colorPalette.innerHTML = ''; // æ¸…ç©ºç°æœ‰è‰²å¡
            palette.forEach(color => {
                const hexColor = rgbToHex(color[0], color[1], color[2]);
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = hexColor;

                const colorCode = document.createElement('div');
                colorCode.className = 'color-code';
                colorCode.textContent = hexColor;

                swatch.appendChild(colorCode);
                colorPalette.appendChild(swatch);

                // ç‚¹å‡»è‰²å—å¤åˆ¶é¢œè‰²ä»£ç 
                swatch.addEventListener('click', () => {
                    copyToClipboard(hexColor);
                });
            });
        }

        /* 
            ç”Ÿæˆè‰²å¡
            ä»ä¸Šä¼ çš„å›¾ç‰‡ä¸­æå–ä¸»è‰²è°ƒï¼Œæ˜¾ç¤ºåœ¨è‰²å¡å±•ç¤ºåŒºåŸŸ
        */
        function generateColorPaletteFromImage() {
            const imagePreview = document.getElementById('imagePreview');
            if (imagePreview.src === '') {
                alert("è¯·å…ˆä¸Šä¼ ä¸€å¼ å›¾ç‰‡ã€‚");
                return;
            }

            // ç¡®ä¿å›¾ç‰‡å·²åŠ è½½
            if (!imagePreview.complete) {
                alert("å›¾ç‰‡å°šæœªåŠ è½½å®Œæ¯•ï¼Œè¯·ç¨åå†è¯•ã€‚");
                return;
            }

            try {
                const palette = colorThief.getPalette(imagePreview, 5); // æå–5ç§é¢œè‰²
                displayColorPalette(palette);
            } catch (error) {
                console.error(error);
                alert("æ— æ³•æå–é¢œè‰²ï¼Œè¯·å°è¯•å…¶ä»–å›¾ç‰‡ã€‚");
            }
        }

        /* 
            ç”Ÿæˆéšæœºè‰²å¡
            ç”ŸæˆæŒ‡å®šæ•°é‡çš„éšæœºé¢œè‰²ï¼Œå¹¶æ˜¾ç¤ºåœ¨è‰²å¡å±•ç¤ºåŒºåŸŸ
        */
        function generateRandomColorPalette() {
            const colorPalette = document.getElementById('color-palette');
            colorPalette.innerHTML = ''; // æ¸…ç©ºç°æœ‰è‰²å¡
            const numberOfColors = 5; // ç”Ÿæˆé¢œè‰²æ•°é‡

            for (let i = 0; i < numberOfColors; i++) {
                const color = getRandomColor();
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = color;

                const colorCode = document.createElement('div');
                colorCode.className = 'color-code';
                colorCode.textContent = color;

                swatch.appendChild(colorCode);
                colorPalette.appendChild(swatch);

                // ç‚¹å‡»è‰²å—å¤åˆ¶é¢œè‰²ä»£ç 
                swatch.addEventListener('click', () => {
                    copyToClipboard(color);
                });
            }
        }

        /* 
            ç‚¹å‡»æŒ‰é’®ç”Ÿæˆè‰²å¡
            ä¸ºè‰²å¡ç”ŸæˆæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶
        */
        document.getElementById('generate-btn').addEventListener('click', generateColorPaletteFromImage);
        document.getElementById('random-generate-btn').addEventListener('click', generateRandomColorPalette);

        /* 
            é¡µé¢åŠ è½½æ—¶åˆå§‹ç”Ÿæˆéšæœºè‰²å¡
            ç”¨æˆ·æ‰“å¼€é¡µé¢æ—¶ï¼Œé»˜è®¤å±•ç¤ºéšæœºè‰²å¡
        */
        window.onload = generateRandomColorPalette;
    </script>
</body>
</html>
