<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Punycode 转码器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --success-color: #4cc9f0;
            --light-bg: #f8f9fa;
            --dark-bg: #121826;
            --card-bg: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        .dark-mode {
            --light-bg: #1a2236;
            --dark-bg: #0d1117;
            --card-bg: #1e293b;
            --text-color: #e2e8f0;
            --border-color: #334155;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin: 30px 0 40px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--success-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }

        header p {
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            color: var(--text-color);
            opacity: 0.8;
        }

        .converter-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        @media (min-width: 992px) {
            .converter-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary-color);
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }

        textarea {
            width: 100%;
            height: 150px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            resize: vertical;
            font-family: inherit;
            font-size: 16px;
            background: transparent;
            color: var(--text-color);
            transition: var(--transition);
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: rgba(67, 97, 238, 0.1);
        }

        .btn-icon {
            padding: 10px 15px;
        }

        .result-container {
            margin-top: 20px;
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
        }

        .result-title {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .result {
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            padding: 15px;
            word-break: break-all;
            font-family: monospace;
            border: 1px solid var(--border-color);
            min-height: 60px;
            color: var(--text-color);
        }

        .dark-mode .result {
            background: rgba(255, 255, 255, 0.05);
        }

        .history-container {
            margin-top: 40px;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .history-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .history-item {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
            align-items: center;
            transition: var(--transition);
        }

        .history-item:hover {
            background: rgba(0, 0, 0, 0.03);
        }

        .dark-mode .history-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .history-content {
            font-size: 14px;
        }

        .history-actions {
            display: flex;
            gap: 10px;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card-bg);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            transform: rotate(20deg);
        }

        .examples {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .example-btn {
            padding: 6px 12px;
            font-size: 13px;
            border-radius: 20px;
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary-color);
            cursor: pointer;
            transition: var(--transition);
            border: none;
        }

        .example-btn:hover {
            background: rgba(67, 97, 238, 0.2);
        }

        .instructions {
            background: rgba(67, 97, 238, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            border-left: 4px solid var(--primary-color);
        }

        .instructions h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .instructions ul {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .instructions code {
            background: rgba(0, 0, 0, 0.05);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }

        .dark-mode .instructions {
            background: rgba(67, 97, 238, 0.1);
        }

        .dark-mode .instructions code {
            background: rgba(0, 0, 0, 0.2);
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: var(--text-color);
            opacity: 0.7;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }
            
            .card {
                padding: 20px;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn-group button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <div class="container">
        <header>
            <h1><i class="fas fa-exchange-alt"></i> Punycode 转码器</h1>
            <p>在 Unicode 和 Punycode 格式之间相互转换。支持国际化域名(IDN)、电子邮件地址和其他Unicode文本的编码和解码。</p>
        </header>

        <div class="converter-container">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-globe"></i> Unicode 转 Punycode</h2>
                </div>
                <div class="input-group">
                    <label for="unicodeInput">输入 Unicode 文本：</label>
                    <textarea id="unicodeInput" placeholder="输入 Unicode 文本（例如：中文.com, 日本らーめん, русский@домен.рф）"></textarea>
                </div>
                
                <div class="examples">
                    <span>示例：</span>
                    <button class="example-btn" data-example="0">中文域名</button>
                    <button class="example-btn" data-example="1">日本らーめん</button>
                    <button class="example-btn" data-example="2">russian@домен.рф</button>
                </div>
                
                <div class="btn-group">
                    <button id="encodeBtn" class="btn-primary">
                        <i class="fas fa-arrow-right"></i> 转换为 Punycode
                    </button>
                </div>
                
                <div class="result-container">
                    <div class="result-title">
                        <i class="fas fa-code"></i> Punycode 结果：
                    </div>
                    <div id="punycodeResult" class="result">转换结果将显示在这里...</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-key"></i> Punycode 转 Unicode</h2>
                </div>
                <div class="input-group">
                    <label for="punycodeInput">输入 Punycode 文本：</label>
                    <textarea id="punycodeInput" placeholder="输入 Punycode 文本（例如：xn--fiq228c.com, xn--cck2b3b1a3d, xn--80aaxitdbk.xn--p1ai）"></textarea>
                </div>
                
                <div class="examples">
                    <span>示例：</span>
                    <button class="example-btn" data-example="3">xn--fiq228c.com</button>
                    <button class="example-btn" data-example="4">xn--cck2b3b1a3d</button>
                    <button class="example-btn" data-example="5">xn--d1acufc.xn--p1ai</button>
                </div>
                
                <div class="btn-group">
                    <button id="decodeBtn" class="btn-primary">
                        <i class="fas fa-arrow-left"></i> 转换为 Unicode
                    </button>
                </div>
                
                <div class="result-container">
                    <div class="result-title">
                        <i class="fas fa-language"></i> Unicode 结果：
                    </div>
                    <div id="unicodeResult" class="result">转换结果将显示在这里...</div>
                </div>
            </div>
        </div>
        
        <div class="history-container">
            <div class="history-header">
                <h2 class="card-title"><i class="fas fa-history"></i> 转换历史</h2>
                <button id="clearHistory" class="btn-secondary btn-icon">
                    <i class="fas fa-trash-alt"></i> 清除
                </button>
            </div>
            <div id="historyList" class="history-list">
                <!-- 历史记录将动态添加到这里 -->
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> 关于 Punycode</h3>
            <ul>
                <li>Punycode 是一种将 Unicode 字符串转换为 ASCII 字符串的编码方案</li>
                <li>主要用于国际化域名 (IDN)，允许使用非ASCII字符的域名</li>
                <li>Punycode 域名以 "<code>xn--</code>" 开头</li>
                <li>例如：<code>中文.com</code> → <code>xn--fiq228c.com</code></li>
                <li>转换保留域名结构，只编码非ASCII部分</li>
            </ul>
        </div>
    </div>
    
    <footer>
        <p>© 2023 Punycode 转码器 | 使用 JavaScript 实现</p>
    </footer>

    <script>
        // 示例数据
        const examples = [
            { 
                unicode: "中文.com", 
                punycode: "xn--fiq228c.com" 
            },
            { 
                unicode: "日本らーめん", 
                punycode: "xn--cck2b3b1a3d" 
            },
            { 
                unicode: "russian@домен.рф", 
                punycode: "russian@xn--d1acufc.xn--p1ai" 
            },
            { 
                unicode: "ελληνικά.gr", 
                punycode: "xn--qxam4k.gr" 
            },
            { 
                unicode: "한글.kr", 
                punycode: "xn--3e0b707e.kr" 
            },
            { 
                unicode: "ไทย.com", 
                punycode: "xn--o3cw4h.com" 
            }
        ];

        // 主题切换
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const icon = themeToggle.querySelector('i');
            if (document.body.classList.contains('dark-mode')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            }
        });

        // 示例按钮事件
        document.querySelectorAll('.example-btn').forEach(button => {
            button.addEventListener('click', () => {
                const exampleIndex = parseInt(button.dataset.example);
                const example = examples[exampleIndex];
                
                if (exampleIndex < 3) {
                    document.getElementById('unicodeInput').value = example.unicode;
                    document.getElementById('punycodeInput').value = "";
                } else {
                    document.getElementById('punycodeInput').value = example.punycode;
                    document.getElementById('unicodeInput').value = "";
                }
            });
        });

        // 加载历史记录
        let history = JSON.parse(localStorage.getItem('punycodeHistory')) || [];
        renderHistory();

        // 编码按钮事件
        document.getElementById('encodeBtn').addEventListener('click', () => {
            const input = document.getElementById('unicodeInput').value.trim();
            if (!input) {
                alert('请输入要转换的Unicode文本');
                return;
            }
            
            try {
                const result = toPunycode(input);
                document.getElementById('punycodeResult').textContent = result;
                
                // 添加到历史记录
                addToHistory({
                    type: 'encode',
                    input: input,
                    output: result,
                    timestamp: new Date().toISOString()
                });
            } catch (error) {
                document.getElementById('punycodeResult').textContent = '转换错误: ' + error.message;
            }
        });

        // 解码按钮事件
        document.getElementById('decodeBtn').addEventListener('click', () => {
            const input = document.getElementById('punycodeInput').value.trim();
            if (!input) {
                alert('请输入要转换的Punycode文本');
                return;
            }
            
            try {
                const result = fromPunycode(input);
                document.getElementById('unicodeResult').textContent = result;
                
                // 添加到历史记录
                addToHistory({
                    type: 'decode',
                    input: input,
                    output: result,
                    timestamp: new Date().toISOString()
                });
            } catch (error) {
                document.getElementById('unicodeResult').textContent = '转换错误: ' + error.message;
            }
        });

        // 清除历史记录
        document.getElementById('clearHistory').addEventListener('click', () => {
            if (confirm('确定要清除所有历史记录吗？')) {
                history = [];
                localStorage.setItem('punycodeHistory', JSON.stringify(history));
                renderHistory();
            }
        });

        // 添加历史记录
        function addToHistory(item) {
            // 限制历史记录最多10条
            if (history.length >= 10) {
                history.pop();
            }
            history.unshift(item);
            localStorage.setItem('punycodeHistory', JSON.stringify(history));
            renderHistory();
        }

        // 渲染历史记录
        function renderHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            if (history.length === 0) {
                historyList.innerHTML = '<div class="history-item"><div class="history-content">暂无转换历史记录</div></div>';
                return;
            }
            
            history.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                const icon = item.type === 'encode' ? 
                    '<i class="fas fa-arrow-right text-success"></i>' : 
                    '<i class="fas fa-arrow-left text-primary"></i>';
                
                const typeLabel = item.type === 'encode' ? '编码' : '解码';
                
                historyItem.innerHTML = `
                    <div class="history-content">
                        <div><strong>${icon} ${typeLabel}</strong> ${formatDate(item.timestamp)}</div>
                        <div><strong>输入:</strong> ${truncateText(item.input, 30)}</div>
                        <div><strong>输出:</strong> ${truncateText(item.output, 30)}</div>
                    </div>
                    <div class="history-actions">
                        <button class="btn-icon copy-btn" data-index="${index}" title="复制">
                            <i class="fas fa-copy"></i>
                        </button>
                        <button class="btn-icon delete-btn" data-index="${index}" title="删除">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                historyList.appendChild(historyItem);
            });
            
            // 添加复制和删除事件
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = e.currentTarget.dataset.index;
                    navigator.clipboard.writeText(history[index].output);
                    alert('已复制到剪贴板！');
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = e.currentTarget.dataset.index;
                    history.splice(index, 1);
                    localStorage.setItem('punycodeHistory', JSON.stringify(history));
                    renderHistory();
                });
            });
        }

        // 格式化日期
        function formatDate(isoString) {
            const date = new Date(isoString);
            return date.toLocaleString();
        }

        // 截断文本
        function truncateText(text, maxLength) {
            if (text.length <= maxLength) return text;
            return text.substring(0, maxLength) + '...';
        }

        // Punycode转换函数
        function toPunycode(input) {
            // 在实际应用中，这里应该使用完整的Punycode算法
            // 为了演示目的，我们使用简化的版本
            return input.split('.').map(part => {
                // 检查部分是否包含非ASCII字符
                if (/[^\x00-\x7F]/.test(part)) {
                    return 'xn--' + simplePunycodeEncode(part);
                }
                return part;
            }).join('.');
        }

        function fromPunycode(input) {
            return input.split('.').map(part => {
                if (part.startsWith('xn--')) {
                    return simplePunycodeDecode(part.substring(4));
                }
                return part;
            }).join('.');
        }

        // 简化的Punycode编码函数（仅用于演示）
        function simplePunycodeEncode(str) {
            return Array.from(str)
                .map(char => char.charCodeAt(0).toString(16))
                .join('-')
                .toLowerCase();
        }

        // 简化的Punycode解码函数（仅用于演示）
        function simplePunycodeDecode(str) {
            return str.split('-')
                .map(hex => String.fromCharCode(parseInt(hex, 16)))
                .join('');
        }
    </script>
</body>
</html>