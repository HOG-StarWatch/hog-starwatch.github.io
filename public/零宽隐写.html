<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <button onclick="goHome()">返回主页</button>
    <title>零宽字符隐写术</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        textarea { width: 100%; height: 100px; margin-bottom: 10px; }
        .result { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>零宽字符隐写术</h1>
    
    <h3>要隐藏的信息:</h3>
    <textarea id="hiddenMessage"></textarea>
    
    <h3>自定义文本:</h3>
    <textarea id="customText"></textarea>
    
    <button onclick="hideMessage()">隐藏信息</button>

    <h3>结果:</h3>
    <textarea id="result" class="result"></textarea>
    <button onclick="copyToClipboard()">复制到剪贴板</button>

    <h3>从结果中提取信息:</h3>
    <button onclick="extractMessage()">提取信息</button>
    <h3>提取的信息:</h3>
    <textarea id="extractedMessage" class="result" readonly></textarea>

    <script>

    // 定义零宽字符
        const ZWSP = '\u200B'; // 零宽空格
        const ZWNJ = '\u200C'; // 零宽连字符

    // 定义隐藏消息函数
        function hideMessage() {
    // 获取用户输入的隐藏消息和自定义文本
            const message = document.getElementById('hiddenMessage').value;
            const customText = document.getElementById('customText').value;
            let encodedMessage = "";

    // 将每个字符编码为二进制形式，并映射到零宽字符
            for (let char of message) {
                const binary = char.charCodeAt(0).toString(2).padStart(8, '0');
                for (let bit of binary) {
                    encodedMessage += bit === '1' ? ZWNJ : ZWSP;
                }
            }

    // 将编码的信息插入自定义文本中
            let resultText = customText.split('');
            for (let i = 0; i < encodedMessage.length; i++) {
                resultText.splice(i, 0, encodedMessage[i]);
            }

    // 将结果文本显示在输出框中
            document.getElementById('result').value = resultText.join('');
        }

    // 定义提取消息函数
        function extractMessage() {
    // 获取用户输入的结果文本
            const inputString = document.getElementById('result').value;
            let binaryMessage = "";
            let extractedMessage = "";

    // 从字符串中提取零宽字符信息
            for (let char of inputString) {
                if (char === ZWNJ) {
                    binaryMessage += '1';
                } else if (char === ZWSP) {
                    binaryMessage += '0';
                }

        // 当二进制字符串长度达到8时，将其转换为字符并添加到提取的消息中
                if (binaryMessage.length === 8) {
                    extractedMessage += String.fromCharCode(parseInt(binaryMessage, 2));
                    binaryMessage = "";
                }
            }

    // 将提取的消息显示在输出框中
            document.getElementById('extractedMessage').value = extractedMessage;
        }

    // 定义复制到剪贴板函数
        function copyToClipboard() {
    // 获取结果文本框
            const textarea = document.getElementById('result');
            textarea.select(); // 选中文本
            document.execCommand('copy'); // 使用 execCommand 复制        
            alert('文本已复制到剪贴板！'); // 提示用户
        }

    // 定义返回主页函数
        function goHome() {
            window.location.href = "/";
        }
    </script>
</body>
</html>
