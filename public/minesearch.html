<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰«é›·æ¸¸æˆï¼ˆæ”¯æŒç§å­ç”Ÿæˆï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            padding: 20px;
        }
        
        .container {
            max-width: 850px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            padding: 25px;
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: #f8f9fa;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #e9ecef;
            margin-bottom: 20px;
        }
        
        .game-config {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            justify-content: space-between;
            align-items: center;
        }
        
        .config-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 150px;
        }
        
        .config-group label {
            font-size: 0.9rem;
            color: #adb5bd;
        }
        
        .config-group input, .config-group select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #4a69bd;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        .config-group input:focus, .config-group select:focus {
            outline: none;
            border-color: #6a89cc;
            box-shadow: 0 0 0 2px rgba(106, 137, 204, 0.3);
        }
        
        .seed-controls {
            display: flex;
            gap: 8px;
            margin-top: 5px;
        }
        
        .seed-controls button {
            padding: 8px 12px;
            font-size: 0.9rem;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.3);
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .counter, .timer {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ff6b6b;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px 20px;
            border-radius: 8px;
            min-width: 100px;
            text-align: center;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        button {
            background-color: #4d96ff;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        button:hover {
            background-color: #6aa8ff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        #reset-btn {
            background-color: #ff9f43;
        }
        
        #reset-btn:hover {
            background-color: #ffb26b;
        }
        
        #generate-seed-btn {
            background-color: #2ed573;
        }
        
        #generate-seed-btn:hover {
            background-color: #40e685;
        }
        
        #share-seed-btn {
            background-color: #9b59b6;
        }
        
        #share-seed-btn:hover {
            background-color: #af7ac5;
        }
        
        .game-board {
            display: grid;
            gap: 2px;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 5px;
            border-radius: 8px;
            margin: 0 auto;
            max-width: 500px;
        }
        
        .cell {
            aspect-ratio: 1;
            background-color: #4a69bd;
            border-radius: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.2rem;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
        }
        
        .cell:hover {
            background-color: #5a79cd;
        }
        
        .cell.revealed {
            background-color: #82ccdd;
            cursor: default;
        }
        
        .cell.mine {
            background-color: #ff6b6b;
        }
        
        .cell.mine::after {
            content: "ğŸ’£";
            font-size: 1.2rem;
        }
        
        .cell.flagged::after {
            content: "ğŸš©";
            font-size: 1rem;
        }
        
        .cell.revealed.mine {
            background-color: #ff4757;
        }
        
        .number-1 { color: #1e90ff; }
        .number-2 { color: #2ed573; }
        .number-3 { color: #ff6b6b; }
        .number-4 { color: #3742fa; }
        .number-5 { color: #ff7f50; }
        .number-6 { color: #2ed573; }
        .number-7 { color: #5352ed; }
        .number-8 { color: #ff4757; }
        
        .game-status {
            text-align: center;
            font-size: 1.5rem;
            height: 40px;
            margin-top: 20px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .win {
            color: #2ed573;
        }
        
        .lose {
            color: #ff6b6b;
        }
        
        .seed-display {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 12px 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .seed-display span {
            color: #ffd166;
            font-weight: bold;
            font-family: monospace;
            font-size: 1.2rem;
            letter-spacing: 1px;
        }
        
        .instructions {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
        }
        
        .instructions h3 {
            margin-bottom: 10px;
            color: #ffd166;
        }
        
        .instructions ul {
            list-style-type: none;
            padding-left: 10px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .instructions li span {
            color: #ffd166;
            font-weight: bold;
        }
        
        footer {
            text-align: center;
            margin-top: 25px;
            color: #adb5bd;
            font-size: 0.9rem;
        }
        
        @media (max-width: 700px) {
            .game-config {
                flex-direction: column;
                align-items: stretch;
            }
            
            .config-group {
                min-width: auto;
            }
            
            .game-board {
                max-width: 95vw;
            }
            
            .cell {
                font-size: 1rem;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .counter, .timer {
                font-size: 1.5rem;
                min-width: 80px;
                padding: 8px 15px;
            }
            
            .game-info {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>æ‰«é›·æ¸¸æˆï¼ˆæ”¯æŒç§å­ç”Ÿæˆï¼‰</h1>
            <div class="subtitle">ä½¿ç”¨ç§å­å€¼å¯ä»¥é‡ç°ç›¸åŒçš„æ¸¸æˆå¸ƒå±€</div>
        </header>
        
        <div class="game-config">
            <div class="config-group">
                <label for="difficulty">éš¾åº¦çº§åˆ«</label>
                <select id="difficulty">
                    <option value="easy">ç®€å• (9Ã—9, 10ä¸ªåœ°é›·)</option>
                    <option value="medium" selected>ä¸­ç­‰ (16Ã—16, 40ä¸ªåœ°é›·)</option>
                    <option value="hard">å›°éš¾ (16Ã—30, 99ä¸ªåœ°é›·)</option>
                    <option value="custom">è‡ªå®šä¹‰</option>
                </select>
            </div>
            
            <div class="config-group">
                <label for="custom-rows">è‡ªå®šä¹‰è¡Œæ•°</label>
                <input type="number" id="custom-rows" min="5" max="30" value="16" disabled>
            </div>
            
            <div class="config-group">
                <label for="custom-cols">è‡ªå®šä¹‰åˆ—æ•°</label>
                <input type="number" id="custom-cols" min="5" max="40" value="16" disabled>
            </div>
            
            <div class="config-group">
                <label for="custom-mines">è‡ªå®šä¹‰åœ°é›·æ•°</label>
                <input type="number" id="custom-mines" min="1" max="200" value="40" disabled>
            </div>
            
            <div class="config-group">
                <label for="seed-input">ç§å­å€¼</label>
                <div class="seed-controls">
                    <input type="text" id="seed-input" placeholder="è¾“å…¥ç§å­æˆ–ç•™ç©ºéšæœºç”Ÿæˆ">
                    <button id="generate-seed-btn">éšæœºç§å­</button>
                    <button id="share-seed-btn">åˆ†äº«ç§å­</button>
                </div>
            </div>
        </div>
        
        <div class="game-info">
            <div class="counter">
                <span id="mine-count">40</span>
            </div>
            
            <div class="controls">
                <button id="reset-btn">é‡æ–°å¼€å§‹</button>
                <button id="hint-btn">æç¤º</button>
            </div>
            
            <div class="timer">
                <span id="time">000</span>
            </div>
        </div>
        
        <div class="game-board" id="game-board"></div>
        
        <div class="game-status" id="game-status"></div>
        
        <div class="seed-display">
            å½“å‰ç§å­: <span id="current-seed">æœªè®¾ç½®</span>
        </div>
        
        <div class="instructions">
            <h3>æ¸¸æˆè¯´æ˜</h3>
            <ul>
                <li><span>å·¦é”®ç‚¹å‡»</span>ï¼šæ‰“å¼€æ ¼å­</li>
                <li><span>å³é”®ç‚¹å‡»</span>ï¼šæ ‡è®°/å–æ¶ˆæ ‡è®°åœ°é›·</li>
                <li><span>ç›®æ ‡</span>ï¼šæ‰“å¼€æ‰€æœ‰éåœ°é›·æ ¼å­</li>
                <li><span>æ•°å­—</span>ï¼šè¡¨ç¤ºå‘¨å›´8ä¸ªæ ¼å­ä¸­çš„åœ°é›·æ•°é‡</li>
                <li><span>ç§å­å€¼</span>ï¼šç›¸åŒçš„ç§å­ä¼šäº§ç”Ÿç›¸åŒçš„æ¸¸æˆå¸ƒå±€ï¼Œå¯ç”¨äºåˆ†äº«æˆ–é‡ç°æ¸¸æˆ</li>
                <li><span>æç¤ºæŒ‰é’®</span>ï¼šé«˜äº®æ˜¾ç¤ºä¸€ä¸ªå®‰å…¨æ ¼å­</li>
            </ul>
        </div>
    </div>

    <script>
        // æ¸¸æˆé…ç½®
        const difficultyPresets = {
            easy: { rows: 9, cols: 9, mines: 10 },
            medium: { rows: 16, cols: 16, mines: 40 },
            hard: { rows: 16, cols: 30, mines: 99 }
        };
        
        let config = {
            rows: 16,
            cols: 16,
            mines: 40,
            seed: null
        };
        
        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            board: [],
            gameOver: false,
            gameWon: false,
            flaggedCount: 0,
            revealedCount: 0,
            startTime: null,
            timerInterval: null,
            seconds: 0,
            currentSeed: null
        };
        
        // DOMå…ƒç´ 
        const gameBoard = document.getElementById('game-board');
        const mineCountElement = document.getElementById('mine-count');
        const timeElement = document.getElementById('time');
        const gameStatusElement = document.getElementById('game-status');
        const resetButton = document.getElementById('reset-btn');
        const hintButton = document.getElementById('hint-btn');
        const difficultySelect = document.getElementById('difficulty');
        const customRowsInput = document.getElementById('custom-rows');
        const customColsInput = document.getElementById('custom-cols');
        const customMinesInput = document.getElementById('custom-mines');
        const seedInput = document.getElementById('seed-input');
        const generateSeedButton = document.getElementById('generate-seed-btn');
        const shareSeedButton = document.getElementById('share-seed-btn');
        const currentSeedElement = document.getElementById('current-seed');
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            gameState.board = [];
            gameState.gameOver = false;
            gameState.gameWon = false;
            gameState.flaggedCount = 0;
            gameState.revealedCount = 0;
            gameState.seconds = 0;
            
            // æ¸…é™¤è®¡æ—¶å™¨
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
                gameState.timerInterval = null;
            }
            
            // è·å–ç§å­å€¼
            let seed = seedInput.value.trim();
            if (seed === '') {
                // å¦‚æœæ²¡æœ‰ç§å­ï¼Œç”Ÿæˆä¸€ä¸ªéšæœºç§å­
                seed = generateRandomSeed();
                seedInput.value = seed;
            }
            
            // è®¾ç½®å½“å‰ç§å­
            gameState.currentSeed = seed;
            config.seed = seed;
            currentSeedElement.textContent = seed;
            
            // æ›´æ–°UI
            mineCountElement.textContent = config.mines;
            timeElement.textContent = '000';
            gameStatusElement.textContent = '';
            gameStatusElement.className = 'game-status';
            
            // è®¾ç½®æ¸¸æˆæ¿å°ºå¯¸
            gameBoard.style.gridTemplateColumns = `repeat(${config.cols}, 1fr)`;
            gameBoard.style.gridTemplateRows = `repeat(${config.rows}, 1fr)`;
            gameBoard.style.maxWidth = `${Math.min(config.cols * 35, 600)}px`;
            
            // åˆ›å»ºæ¸¸æˆæ¿
            createBoard();
            
            // æ¸²æŸ“æ¸¸æˆæ¿
            renderBoard();
        }
        
        // ç”Ÿæˆéšæœºç§å­
        function generateRandomSeed() {
            // ç”Ÿæˆä¸€ä¸ªéšæœºçš„ç§å­å­—ç¬¦ä¸²
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        // åŸºäºç§å­çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨
        function seededRandom(seed) {
            // å°†ç§å­è½¬æ¢ä¸ºå“ˆå¸Œå€¼
            let hash = 0;
            for (let i = 0; i < seed.length; i++) {
                hash = ((hash << 5) - hash) + seed.charCodeAt(i);
                hash = hash & hash; // è½¬æ¢ä¸º32ä½æ•´æ•°
            }
            
            // è¿”å›ä¸€ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆå™¨å‡½æ•°
            return function() {
                hash = (hash * 9301 + 49297) % 233280;
                return hash / 233280;
            };
        }
        
        // åˆ›å»ºæ¸¸æˆæ¿
        function createBoard() {
            // åˆå§‹åŒ–ç©ºæ£‹ç›˜
            for (let i = 0; i < config.rows; i++) {
                gameState.board[i] = [];
                for (let j = 0; j < config.cols; j++) {
                    gameState.board[i][j] = {
                        isMine: false,
                        isRevealed: false,
                        isFlagged: false,
                        neighborMines: 0
                    };
                }
            }
            
            // ä½¿ç”¨ç§å­ç”Ÿæˆéšæœºæ•°ç”Ÿæˆå™¨
            const random = seededRandom(config.seed);
            
            // éšæœºæ”¾ç½®åœ°é›·
            let minesPlaced = 0;
            while (minesPlaced < config.mines) {
                const row = Math.floor(random() * config.rows);
                const col = Math.floor(random() * config.cols);
                
                // ç¡®ä¿ä¸é‡å¤æ”¾ç½®åœ°é›·
                if (!gameState.board[row][col].isMine) {
                    gameState.board[row][col].isMine = true;
                    minesPlaced++;
                }
            }
            
            // è®¡ç®—æ¯ä¸ªæ ¼å­çš„é‚»å±…åœ°é›·æ•°
            for (let i = 0; i < config.rows; i++) {
                for (let j = 0; j < config.cols; j++) {
                    if (!gameState.board[i][j].isMine) {
                        gameState.board[i][j].neighborMines = countNeighborMines(i, j);
                    }
                }
            }
        }
        
        // è®¡ç®—é‚»å±…åœ°é›·æ•°
        function countNeighborMines(row, col) {
            let count = 0;
            
            for (let i = -1; i <= 1; i++) {
                for (let j = -1; j <= 1; j++) {
                    const newRow = row + i;
                    const newCol = col + j;
                    
                    // è·³è¿‡å½“å‰æ ¼å­
                    if (i === 0 && j === 0) continue;
                    
                    // æ£€æŸ¥è¾¹ç•Œ
                    if (newRow >= 0 && newRow < config.rows && newCol >= 0 && newCol < config.cols) {
                        if (gameState.board[newRow][newCol].isMine) {
                            count++;
                        }
                    }
                }
            }
            
            return count;
        }
        
        // æ¸²æŸ“æ¸¸æˆæ¿
        function renderBoard() {
            // æ¸…ç©ºæ¸¸æˆæ¿
            gameBoard.innerHTML = '';
            
            // åˆ›å»ºæ¯ä¸ªæ ¼å­
            for (let i = 0; i < config.rows; i++) {
                for (let j = 0; j < config.cols; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    
                    const cellData = gameState.board[i][j];
                    
                    // å¦‚æœæ ¼å­å·²ç¿»å¼€
                    if (cellData.isRevealed) {
                        cell.classList.add('revealed');
                        
                        if (cellData.isMine) {
                            cell.classList.add('mine');
                        } else if (cellData.neighborMines > 0) {
                            cell.textContent = cellData.neighborMines;
                            cell.classList.add(`number-${cellData.neighborMines}`);
                        }
                    } 
                    // å¦‚æœæ ¼å­è¢«æ ‡è®°
                    else if (cellData.isFlagged) {
                        cell.classList.add('flagged');
                    }
                    
                    // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    cell.addEventListener('click', () => handleCellClick(i, j));
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        handleRightClick(i, j);
                    });
                    
                    gameBoard.appendChild(cell);
                }
            }
        }
        
        // å¤„ç†å·¦é”®ç‚¹å‡»
        function handleCellClick(row, col) {
            // å¦‚æœæ¸¸æˆç»“æŸæˆ–å·²èµ¢ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ
            if (gameState.gameOver || gameState.gameWon) return;
            
            // å¦‚æœæ ¼å­å·²ç¿»å¼€æˆ–è¢«æ ‡è®°ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ
            if (gameState.board[row][col].isRevealed || gameState.board[row][col].isFlagged) return;
            
            // å¼€å§‹è®¡æ—¶ï¼ˆå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ç‚¹å‡»ï¼‰
            if (gameState.startTime === null) {
                startTimer();
            }
            
            // ç¿»å¼€æ ¼å­
            revealCell(row, col);
            
            // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
            checkGameStatus();
            
            // é‡æ–°æ¸²æŸ“æ¸¸æˆæ¿
            renderBoard();
        }
        
        // å¤„ç†å³é”®ç‚¹å‡»
        function handleRightClick(row, col) {
            // å¦‚æœæ¸¸æˆç»“æŸæˆ–å·²èµ¢ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ
            if (gameState.gameOver || gameState.gameWon) return;
            
            // å¦‚æœæ ¼å­å·²ç¿»å¼€ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ
            if (gameState.board[row][col].isRevealed) return;
            
            const cell = gameState.board[row][col];
            
            // åˆ‡æ¢æ ‡è®°çŠ¶æ€
            cell.isFlagged = !cell.isFlagged;
            
            // æ›´æ–°æ ‡è®°è®¡æ•°
            if (cell.isFlagged) {
                gameState.flaggedCount++;
            } else {
                gameState.flaggedCount--;
            }
            
            // æ›´æ–°åœ°é›·è®¡æ•°æ˜¾ç¤º
            mineCountElement.textContent = config.mines - gameState.flaggedCount;
            
            // é‡æ–°æ¸²æŸ“æ¸¸æˆæ¿
            renderBoard();
        }
        
        // ç¿»å¼€æ ¼å­
        function revealCell(row, col) {
            const cell = gameState.board[row][col];
            
            // å¦‚æœæ ¼å­å·²ç¿»å¼€æˆ–è¢«æ ‡è®°ï¼Œç›´æ¥è¿”å›
            if (cell.isRevealed || cell.isFlagged) return;
            
            // æ ‡è®°ä¸ºå·²ç¿»å¼€
            cell.isRevealed = true;
            gameState.revealedCount++;
            
            // å¦‚æœç‚¹å‡»åˆ°åœ°é›·ï¼Œæ¸¸æˆç»“æŸ
            if (cell.isMine) {
                gameState.gameOver = true;
                revealAllMines();
                return;
            }
            
            // å¦‚æœæ ¼å­æ²¡æœ‰é‚»å±…åœ°é›·ï¼Œé€’å½’ç¿»å¼€ç›¸é‚»æ ¼å­
            if (cell.neighborMines === 0) {
                for (let i = -1; i <= 1; i++) {
                    for (let j = -1; j <= 1; j++) {
                        const newRow = row + i;
                        const newCol = col + j;
                        
                        // æ£€æŸ¥è¾¹ç•Œ
                        if (newRow >= 0 && newRow < config.rows && newCol >= 0 && newCol < config.cols) {
                            revealCell(newRow, newCol);
                        }
                    }
                }
            }
        }
        
        // æ˜¾ç¤ºæ‰€æœ‰åœ°é›·ï¼ˆæ¸¸æˆç»“æŸæ—¶ï¼‰
        function revealAllMines() {
            for (let i = 0; i < config.rows; i++) {
                for (let j = 0; j < config.cols; j++) {
                    if (gameState.board[i][j].isMine) {
                        gameState.board[i][j].isRevealed = true;
                    }
                }
            }
        }
        
        // å¼€å§‹è®¡æ—¶å™¨
        function startTimer() {
            gameState.startTime = Date.now();
            gameState.timerInterval = setInterval(() => {
                gameState.seconds = Math.floor((Date.now() - gameState.startTime) / 1000);
                timeElement.textContent = gameState.seconds.toString().padStart(3, '0');
                
                // é™åˆ¶æœ€å¤§æ˜¾ç¤º999ç§’
                if (gameState.seconds >= 999) {
                    clearInterval(gameState.timerInterval);
                }
            }, 1000);
        }
        
        // æ£€æŸ¥æ¸¸æˆçŠ¶æ€
        function checkGameStatus() {
            // å¦‚æœæ¸¸æˆå·²ç»ç»“æŸï¼ˆç‚¹åˆ°åœ°é›·ï¼‰
            if (gameState.gameOver) {
                gameStatusElement.textContent = 'æ¸¸æˆç»“æŸï¼ä½ è¸©åˆ°äº†åœ°é›·ï¼';
                gameStatusElement.classList.add('lose');
                clearInterval(gameState.timerInterval);
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦èµ¢å¾—æ¸¸æˆï¼ˆæ‰€æœ‰éåœ°é›·æ ¼å­éƒ½å·²ç¿»å¼€ï¼‰
            const totalSafeCells = config.rows * config.cols - config.mines;
            if (gameState.revealedCount === totalSafeCells) {
                gameState.gameWon = true;
                gameStatusElement.textContent = 'æ­å–œï¼ä½ èµ¢äº†ï¼';
                gameStatusElement.classList.add('win');
                clearInterval(gameState.timerInterval);
            }
        }
        
        // æç¤ºåŠŸèƒ½
        function provideHint() {
            // å¦‚æœæ¸¸æˆç»“æŸæˆ–å·²èµ¢ï¼Œä¸æä¾›æç¤º
            if (gameState.gameOver || gameState.gameWon) return;
            
            // æ‰¾åˆ°æ‰€æœ‰æœªç¿»å¼€ä¸”æœªæ ‡è®°çš„å®‰å…¨æ ¼å­
            const safeCells = [];
            
            for (let i = 0; i < config.rows; i++) {
                for (let j = 0; j < config.cols; j++) {
                    const cell = gameState.board[i][j];
                    if (!cell.isRevealed && !cell.isFlagged && !cell.isMine) {
                        safeCells.push({row: i, col: j});
                    }
                }
            }
            
            // å¦‚æœæ²¡æœ‰å®‰å…¨æ ¼å­ï¼Œè¿”å›
            if (safeCells.length === 0) return;
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªå®‰å…¨æ ¼å­
            const randomIndex = Math.floor(Math.random() * safeCells.length);
            const hintCell = safeCells[randomIndex];
            
            // é«˜äº®æ˜¾ç¤ºæç¤ºçš„æ ¼å­
            const cellElement = document.querySelector(`.cell[data-row="${hintCell.row}"][data-col="${hintCell.col}"]`);
            cellElement.style.backgroundColor = '#ffd166';
            cellElement.style.boxShadow = '0 0 15px #ffd166';
            
            // 2ç§’åæ¢å¤åŸçŠ¶
            setTimeout(() => {
                if (cellElement) {
                    cellElement.style.backgroundColor = '';
                    cellElement.style.boxShadow = '';
                }
            }, 2000);
        }
        
        // æ›´æ–°é…ç½®åŸºäºéš¾åº¦é€‰æ‹©
        function updateConfigFromDifficulty() {
            const difficulty = difficultySelect.value;
            
            if (difficulty === 'custom') {
                // å¯ç”¨è‡ªå®šä¹‰è¾“å…¥
                customRowsInput.disabled = false;
                customColsInput.disabled = false;
                customMinesInput.disabled = false;
                
                // ä½¿ç”¨è‡ªå®šä¹‰å€¼
                config.rows = parseInt(customRowsInput.value) || 16;
                config.cols = parseInt(customColsInput.value) || 16;
                config.mines = parseInt(customMinesInput.value) || 40;
            } else {
                // ç¦ç”¨è‡ªå®šä¹‰è¾“å…¥
                customRowsInput.disabled = true;
                customColsInput.disabled = true;
                customMinesInput.disabled = true;
                
                // ä½¿ç”¨é¢„è®¾å€¼
                const preset = difficultyPresets[difficulty];
                config.rows = preset.rows;
                config.cols = preset.cols;
                config.mines = preset.mines;
                
                // æ›´æ–°è‡ªå®šä¹‰è¾“å…¥æ˜¾ç¤º
                customRowsInput.value = preset.rows;
                customColsInput.value = preset.cols;
                customMinesInput.value = preset.mines;
            }
            
            // ç¡®ä¿åœ°é›·æ•°ä¸è¶…è¿‡æ ¼å­æ€»æ•°
            const maxMines = config.rows * config.cols - 1;
            if (config.mines > maxMines) {
                config.mines = maxMines;
                customMinesInput.value = maxMines;
            }
            
            // é‡æ–°åˆå§‹åŒ–æ¸¸æˆ
            initGame();
        }
        
        // åˆ†äº«ç§å­
        function shareSeed() {
            const seed = gameState.currentSeed;
            if (!seed) return;
            
            // åˆ›å»ºåˆ†äº«æ–‡æœ¬
            const shareText = `æ‰«é›·æ¸¸æˆ - ç§å­: ${seed}\néš¾åº¦: ${difficultySelect.options[difficultySelect.selectedIndex].text}\nå¸ƒå±€: ${config.rows}Ã—${config.cols}, ${config.mines}ä¸ªåœ°é›·\n\nä½¿ç”¨ç›¸åŒç§å­å¯ä»¥é‡ç°æ¸¸æˆå¸ƒå±€ï¼`;
            
            // å¤åˆ¶åˆ°å‰ªè´´æ¿
            navigator.clipboard.writeText(shareText).then(() => {
                alert('ç§å­å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n\n' + shareText);
            }).catch(err => {
                // å¦‚æœå‰ªè´´æ¿APIä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ³•
                const textArea = document.createElement('textarea');
                textArea.value = shareText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('ç§å­å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n\n' + shareText);
            });
        }
        
        // äº‹ä»¶ç›‘å¬å™¨
        resetButton.addEventListener('click', initGame);
        hintButton.addEventListener('click', provideHint);
        
        difficultySelect.addEventListener('change', updateConfigFromDifficulty);
        
        customRowsInput.addEventListener('change', () => {
            config.rows = parseInt(customRowsInput.value) || 16;
            difficultySelect.value = 'custom';
            updateConfigFromDifficulty();
        });
        
        customColsInput.addEventListener('change', () => {
            config.cols = parseInt(customColsInput.value) || 16;
            difficultySelect.value = 'custom';
            updateConfigFromDifficulty();
        });
        
        customMinesInput.addEventListener('change', () => {
            config.mines = parseInt(customMinesInput.value) || 40;
            difficultySelect.value = 'custom';
            updateConfigFromDifficulty();
        });
        
        generateSeedButton.addEventListener('click', () => {
            seedInput.value = generateRandomSeed();
            initGame();
        });
        
        shareSeedButton.addEventListener('click', shareSeed);
        
        seedInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                initGame();
            }
        });
        
        // åˆå§‹åŒ–æ¸¸æˆ
        initGame();
    </script>
</body>
</html>