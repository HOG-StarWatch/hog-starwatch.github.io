# CMD Base64 打包与释放工具

这是一个基于 Windows 批处理的文件打包工具集，可以将文件转换为独立的自解压/自释放脚本。

## 工具列表与对比

| 工具名称 | 打包模式 | 多文件支持 | 压缩 | 适用场景 |
| :--- | :--- | :---: | :---: | :--- |
| [**`pack_zip_b64.cmd`**](./pack_zip_b64.cmd.json) | **ZIP (可选模式)** | ✅ | ✅/❌ | **通用推荐**。交互式选择“强力压缩”、“快速压缩”或“仅存储”模式，功能最全。 |
| [**`pack_single_b64.cmd`**](./pack_single_b64.cmd.json) | **直接 Base64** | ❌ | ❌ | **单文件最简逻辑**。无压缩，逻辑最简单，依赖最少。 |

---

## 使用说明

### 1. 打包文件

**方法 A：拖拽（推荐）**
1.  选中你想要打包的文件。
    *   *对于 `pack_zip_b64.cmd`，支持多选。*
    *   *对于 `pack_single_b64.cmd`，仅支持拖入一个文件。（拖入多个文件会操作最后点选的那一个文件）*
2.  将文件拖放到对应的脚本图标上。
3.  脚本会自动运行。
    *   `pack_zip_b64.cmd` 会提示选择压缩模式（默认强力压缩）。
4.  最终在当前目录下生成 `release_...cmd`。

**方法 B：双击运行**
1.  双击运行脚本。
2.  根据提示输入文件路径。

*注意：所有工具均不支持打包文件夹。*

### 2. 分发与解压

1.  将生成的 `release_xxx.cmd` 发送给其他用户。
2.  用户双击运行该脚本。
3.  脚本会提示安全警告（防止覆盖同名文件）。
4.  用户按任意键确认后，文件将自动释放到当前目录。

---

## 技术细节

*   **ZIP 模式 (`pack_zip_b64`)**：
    *   使用 PowerShell `Compress-Archive` 创建 ZIP 容器。
    *   交互式选择压缩级别：
        *   **强力压缩** (`Optimal`)：适合文本、代码、未压缩数据。
        *   **快速压缩** (`Fastest`)：平衡速度与体积，适合大文件。
        *   **仅存储** (`NoCompression`)：适合已压缩文件（如 .zip, .jpg, .mp4），速度快。
    *   解压时先还原 ZIP，再通过 `Expand-Archive` 释放。
*   **直接模式 (`pack_single_b64`)**：
    *   不创建 ZIP 容器。
    *   直接使用 `certutil` 对原文件进行 Base64 编码。
    *   释放时直接解码为目标文件，无需解压步骤。
*   **兼容性**：
    *   生成的脚本支持中文路径和文件名（UTF-8）。
    *   环境要求：Windows 10/11 或安装了 PowerShell 的旧版 Windows。
